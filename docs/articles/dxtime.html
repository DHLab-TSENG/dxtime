<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title> • dxtime</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="">
<meta property="og:description" content="dxtime">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dxtime</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/dxtime.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="dxtime_files/header-attrs-2.5/header-attrs.js"></script><link href="dxtime_files/anchor-sections-1.0/anchor-sections.css" rel="stylesheet">
<script src="dxtime_files/anchor-sections-1.0/anchor-sections.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Getting started with dxtime</h1>
                        <h4 class="author">Yi-An, Chu</h4>
            
            <h4 class="date">2021-04-27</h4>
      
      
      <div class="hidden name"><code>dxtime.Rmd</code></div>

    </div>

    
    
<div id="安裝套件" class="section level2">
<h2 class="hasAnchor">
<a href="#%E5%AE%89%E8%A3%9D%E5%A5%97%E4%BB%B6" class="anchor"></a>安裝套件</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span>
<span class="co"># Install development version from GitHub</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span><span class="op">(</span><span class="st">"DHLab-TSENG/dxtime"</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">dxtime</span><span class="op">)</span></code></pre></div>
<pre><code>## Warning: package 'C:/Users/anay1/Desktop/R/dxtime' is not available for this version of R
## 
## A version of this package for your version of R might be available elsewhere,
## see the ideas at
## https://cran.r-project.org/doc/manuals/r-patched/R-admin.html#Installing-packages</code></pre>
<pre><code>## Warning: replacing previous import 'data.table::transpose' by 'purrr::transpose'
## when loading 'dxtime'</code></pre>
</div>
<div id="範例資料" class="section level2">
<h2 class="hasAnchor">
<a href="#%E7%AF%84%E4%BE%8B%E8%B3%87%E6%96%99" class="anchor"></a>範例資料</h2>
<p>以下功能介紹皆以<code>pat_dm</code>以及<code>record_dm</code>做為範例。<br>
pat_dm中共6000名個案，1000位病例組(label=1)，5000位為對照組(label=0);<br>
record_dm為該6000名個案在指標日(發生疾病/最後一筆…)的之診斷紀錄。</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">pat_dm</span><span class="op">)</span>
<span class="co">#&gt;      ID label SEX   age   BIRTHDAY</span>
<span class="co">#&gt; 1: 5191     0   F 67.36 1901-06-15</span>
<span class="co">#&gt; 2: 2360     0   M 59.32 1909-07-05</span>
<span class="co">#&gt; 3: 4222     0   F 38.08 1930-09-25</span>
<span class="co">#&gt; 4: 5739     0   M 71.53 1897-04-01</span>
<span class="co">#&gt; 5: 5122     0   F 60.57 1906-04-09</span>
<span class="co">#&gt; 6: 3205     0   F 78.66 1889-11-24</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">record_dm</span><span class="op">)</span>
<span class="co">#&gt;      ID  ICD       date</span>
<span class="co">#&gt; 1: 5191 4019 1965-07-08</span>
<span class="co">#&gt; 2: 5191 2720 1965-07-08</span>
<span class="co">#&gt; 3: 5191 7840 1965-07-08</span>
<span class="co">#&gt; 4: 5191 4019 1965-09-30</span>
<span class="co">#&gt; 5: 5191 2720 1965-09-30</span>
<span class="co">#&gt; 6: 5191 7840 1965-09-30</span></code></pre></div>
</div>
<div id="功能說明" class="section level2">
<h2 class="hasAnchor">
<a href="#%E5%8A%9F%E8%83%BD%E8%AA%AA%E6%98%8E" class="anchor"></a>功能說明</h2>
<div id="一篩選符合研究長度之個案及診斷紀錄" class="section level3">
<h3 class="hasAnchor">
<a href="#%E4%B8%80%E7%AF%A9%E9%81%B8%E7%AC%A6%E5%90%88%E7%A0%94%E7%A9%B6%E9%95%B7%E5%BA%A6%E4%B9%8B%E5%80%8B%E6%A1%88%E5%8F%8A%E8%A8%BA%E6%96%B7%E7%B4%80%E9%8C%84" class="anchor"></a>一、篩選符合研究長度之個案及診斷紀錄</h3>
<p>在對照病例研究，會探討回溯期間內的暴露因子與疾病發生的關係。隨著回溯時間長度越長，所囊括的暴露的危險因子會越多，樣本比較之下，將會造成「回溯時長較長的樣本，危險因子較多」的偏誤。<br>
為避免這種偏誤，固定追蹤時長是較佳的作法。但每個樣本的發病日期(indexday)並不相同，在filterCasesRecords()可回推追蹤時間，找出追蹤時間範圍內的診斷資料；此外，資料長度不足的樣本也可將之排除。</p>
<p>需設定的參數有:<br><code>predictwindow</code>: 預測天數，意指「想要於指標日多久前進行預測」。<br><code>followindow</code>：此研究所設定的追蹤時長，將用於篩選時間範圍內的診斷紀錄。<br><code>followindow_limit</code>：將資料長度不足的個案於以排除，預設為0。<br><code>count_limit</code>：若是紀錄筆數過少，可能意味著該個案極少至此醫療單位看診，研究者可設定診斷紀錄的數量下限，來決定是否採納此個案之紀錄，預設為0。</p>
<p>執行結束會產生兩種結果，分別是DataFile_pat及DataFile_rec。</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#dxData &lt;- merge(record_dm,pat_dm[,c("ID","label")],by="ID",all.x=T)</span>
<span class="va">length</span> <span class="op">&lt;-</span> <span class="fu">filterCasesRecords</span><span class="op">(</span>DataFile <span class="op">=</span> <span class="va">record_dm</span>,
                             ID <span class="op">=</span> <span class="va">ID</span>,
                             ICD <span class="op">=</span> <span class="va">ICD</span>,
                             date <span class="op">=</span> <span class="va">date</span>,
                             predictwindow <span class="op">=</span> <span class="fl">180</span>, 
                             followindow <span class="op">=</span> <span class="fl">6500</span>, 
                             followindow_limit <span class="op">=</span> <span class="fl">1800</span>, 
                             count_limit <span class="op">=</span> <span class="fl">2</span> 
                             <span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">length</span><span class="op">$</span><span class="va">DataFile_pat</span><span class="op">)</span> 
<span class="co">#&gt;      ID  firstdate  indexdate followperiod   n  cri</span>
<span class="co">#&gt; 1: 5191 1952-03-05 1968-10-24         5897 167 TRUE</span>
<span class="co">#&gt; 2: 2360 1951-10-17 1968-10-30         6043  30 TRUE</span>
<span class="co">#&gt; 3: 4222 1952-04-10 1968-10-26         5863 610 TRUE</span>
<span class="co">#&gt; 4: 5739 1951-07-24 1968-10-12         6110 346 TRUE</span>
<span class="co">#&gt; 5: 5122 1951-07-13 1966-11-02         5411 120 TRUE</span>
<span class="co">#&gt; 6: 3205 1951-03-26 1968-07-23         6149 541 TRUE</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">length</span><span class="op">$</span><span class="va">DataFile_rec</span><span class="op">)</span> 
<span class="co">#&gt;      ID  ICD       date</span>
<span class="co">#&gt; 1: 5191 4019 1965-07-08</span>
<span class="co">#&gt; 2: 5191 2720 1965-07-08</span>
<span class="co">#&gt; 3: 5191 7840 1965-07-08</span>
<span class="co">#&gt; 4: 5191 4019 1965-09-30</span>
<span class="co">#&gt; 5: 5191 2720 1965-09-30</span>
<span class="co">#&gt; 6: 5191 7840 1965-09-30</span></code></pre></div>
<p>以上框結果說明：</p>
<p>第一種結果<code>DataFile_pat</code>，followperiod計算該個案在預測日之前的資料長度，而n在全部資料中計算該個案的資料筆數，如符合研究設定的篩選條件的個案，在cri顯示TRUE，反之則為FALSE。</p>
<p>第二種資料<code>DataFile_rec</code>，從符合個案的資料篩選出符合研究長度(followindow)的診斷紀錄。</p>
</div>
<div id="二配對個案" class="section level3">
<h3 class="hasAnchor">
<a href="#%E4%BA%8C%E9%85%8D%E5%B0%8D%E5%80%8B%E6%A1%88" class="anchor"></a>二、配對個案</h3>
<p>避免干擾因子的影響，研究者可將重要的人口學特徵，例如:性別、年齡、種族等等進行配對，使對照組的人口學特徵的分布與病例組相似。在matchCases()使用傾向配對的方法，將配對變數置入羅吉斯回歸中，得到所有干擾因子的發病機率pscore。最後以pscore相同者配對，找出匹配病例組的對照組。<br>
使用者須給定要匹配的變量以及label。將匹配變量以向量輸入至<code>matchedVariable</code>參數。結果會輸出被配對到個個案以及pscore。</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">match</span> <span class="op">&lt;-</span> <span class="fu">matchCases</span><span class="op">(</span>DataFile <span class="op">=</span> <span class="va">pat_dm</span>,
                    ID <span class="op">=</span> <span class="va">ID</span>,
                    label <span class="op">=</span> <span class="va">label</span>,
                    matchedVariable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"age"</span>,<span class="st">"SEX"</span><span class="op">)</span><span class="op">)</span>
<span class="co"># match &lt;- matchCases(DataFile = pat_dm %&gt;% filter(pat_dm$ID %in% length$DataFile_pat$ID),</span>
<span class="co">#                     ID = ID,</span>
<span class="co">#                     label = label,</span>
<span class="co">#                     matchedVariable = c("age","SEX"))</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">match</span><span class="op">)</span>
<span class="co">#&gt;      ID label   age SEX    pscore</span>
<span class="co">#&gt; 1: 5191     0 67.36   F 0.1691224</span>
<span class="co">#&gt; 2: 2360     0 59.32   M 0.1826436</span>
<span class="co">#&gt; 3: 4222     0 38.08   F 0.1070428</span>
<span class="co">#&gt; 4: 5739     0 71.53   M 0.2179329</span>
<span class="co">#&gt; 5: 5122     0 60.57   F 0.1525630</span>
<span class="co">#&gt; 6: 3205     0 78.66   F 0.1998025</span>
<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">match</span><span class="op">)</span>
<span class="co">#&gt; [1] 6000</span></code></pre></div>
</div>
<div id="三切分時間窗" class="section level3">
<h3 class="hasAnchor">
<a href="#%E4%B8%89%E5%88%87%E5%88%86%E6%99%82%E9%96%93%E7%AA%97" class="anchor"></a>三、切分時間窗</h3>
<p>由於在不同的暴露期間，其他疾病與觀察疾病的關聯會有所差異，使用cutWindow()能將暴露期間切分為數個時間窗，呈現出樣本罹患所有疾病的狀況。另外，此方法使用的是grouped code的方式，將ICD以CCS分類，最後以二元碼的方式呈現。<br>
在劃分時間窗時，除了群組編碼的轉換，另外一個重要的變數:年齡，也可以一併進行處理，由於年齡會隨時間變化，同一個樣本在不同時間窗的年齡會隨之推移，因此cutWindow()可在切分時間窗時一併進行窗內年齡的計算，最後可選擇以二元碼(預設以45歲為分界)或以實際數值的型態呈現。</p>
<p>需設定的參數有:<br><code>getPeriodage</code>:預設為FALSE，如設定為TRUE，則需要在輸入資料中先給定生日資料，最後計算出的periodage以數字型態呈現，若需要以二元形式呈現，可將binaryage=T。<br><code>predictwindow</code>: 預測天數，意指「想要於指標日多久前進行預測」。<br><code>window</code>：設定時間窗的長度。<br><code>N</code>：設定時間窗數量，注意：若該個案在某時間窗中沒有診斷資料，將會自動補0。<br><code>icdcount</code>：定義在追蹤期間，多少個疾病診斷碼(ICD)視為該患者具有該疾病(ccs)。</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># forcut &lt;- merge(length$DataFile_rec %&gt;% filter(ID %in% match$ID),pat_dm[,.(ID,BIRTHDAY)],all.x=T)</span>
<span class="va">forcut</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html">merge</a></span><span class="op">(</span><span class="va">record_dm</span>,<span class="va">pat_dm</span><span class="op">[</span>,<span class="fu">.</span><span class="op">(</span><span class="va">ID</span>,<span class="va">BIRTHDAY</span><span class="op">)</span><span class="op">]</span>,all.x<span class="op">=</span><span class="cn">T</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">forcut</span><span class="op">)</span>
<span class="co">#&gt;    ID   ICD       date   BIRTHDAY</span>
<span class="co">#&gt; 1:  1  7823 1965-09-22 1926-12-29</span>
<span class="co">#&gt; 2:  1  2859 1965-09-22 1926-12-29</span>
<span class="co">#&gt; 3:  1  5829 1965-09-22 1926-12-29</span>
<span class="co">#&gt; 4:  1  7823 1965-09-15 1926-12-29</span>
<span class="co">#&gt; 5:  1 25000 1965-09-15 1926-12-29</span>
<span class="co">#&gt; 6:  1 25040 1965-09-08 1926-12-29</span>
<span class="va">windowcut</span> <span class="op">&lt;-</span> <span class="fu">cutWindow</span><span class="op">(</span>DataFile <span class="op">=</span> <span class="va">forcut</span> , 
                       ID <span class="op">=</span> <span class="va">ID</span> ,
                       ICD <span class="op">=</span> <span class="va">ICD</span> , 
                       date <span class="op">=</span> <span class="va">date</span> ,
                       getPeriodage <span class="op">=</span> <span class="cn">T</span>,
                       <span class="co">#binaryage = T ,</span>
                       BIRTHDAY <span class="op">=</span> <span class="va">BIRTHDAY</span> ,
                       predictwindow <span class="op">=</span> <span class="fl">180</span> ,
                       window <span class="op">=</span> <span class="fl">360</span> , 
                       N <span class="op">=</span> <span class="fl">5</span> ,
                       icdcount<span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt; Wrong ICD format: total 803 ICD codes (the number of occurrences is in brackets)</span>
<span class="co">#&gt; c("5640 (15394)", "585 (12586)", "2500 (9200)", "2740 (5371)", "6009 (4601)", "5210 (4426)", "5714 (3990)", "5234 (3576)", "6000 (3024)", "V048 (2817)")</span>
<span class="co">#&gt;  </span>
<span class="co">#&gt; Wrong ICD version: total 63 ICD codes (the number of occurrences is in brackets)</span>
<span class="co">#&gt; c("25000 (3)", "07030 (2)", "1550 (2)", "2449 (2)", "2724 (2)", "2761 (2)", "4019 (2)", "03849 (1)", "05319 (1)", "1533 (1)")</span>
<span class="co">#&gt;  </span>
<span class="co">#&gt; Warning: The ICD mentioned above matches to "NA" due to the format or other</span>
<span class="co">#&gt; issues.</span>
<span class="co">#&gt; Warning: "Wrong ICD format" means the ICD has wrong format</span>
<span class="co">#&gt; Warning: "Wrong ICD version" means the ICD classify to wrong ICD version (cause</span>
<span class="co">#&gt; the "icd10usingDate" or other issues)</span>
<span class="co">#&gt; Wrong ICD format: total 322 ICD codes (the number of occurrences is in brackets)</span>
<span class="co">#&gt; c("585 (1352)", "M791 (894)", "E780 (831)", "5640 (784)", "K0532 (539)", "E11359 (532)", "2500 (381)", "Z2251 (317)", "6009 (247)", "Z2252 (235)")</span>
<span class="co">#&gt;  </span>
<span class="co">#&gt; Wrong ICD version: total 9 ICD codes (the number of occurrences is in brackets)</span>
<span class="co">#&gt; c("1533 (1)", "2390 (1)", "2800 (1)", "28522 (1)", "34291 (1)", "34292 (1)", "43491 (1)", "4373 (1)", "V5789 (1)")</span>
<span class="co">#&gt;  </span>
<span class="co">#&gt; Warning: The ICD mentioned above matches to "NA" due to the format or other</span>
<span class="co">#&gt; issues.</span>
<span class="co">#&gt; Warning: "Wrong ICD format" means the ICD has wrong format</span>
<span class="co">#&gt; Warning: "Wrong ICD version" means the ICD classify to wrong ICD version (cause</span>
<span class="co">#&gt; the "icd10usingDate" or other issues)</span>
<span class="co">#&gt; Wrong ICD format: total 325 ICD codes (the number of occurrences is in brackets)</span>
<span class="co">#&gt; c("585 (1012)", "E780 (777)", "M791 (771)", "5640 (761)", "E11359 (505)", "K0532 (468)", "Z2251 (315)", "2500 (277)", "6009 (242)", "2740 (237)")</span>
<span class="co">#&gt;  </span>
<span class="co">#&gt; Wrong ICD version: total 7 ICD codes (the number of occurrences is in brackets)</span>
<span class="co">#&gt; c("2761 (1)", "2768 (1)", "53011 (1)", "53390 (1)", "53540 (1)", "5781 (1)", "7948 (1)")</span>
<span class="co">#&gt;  </span>
<span class="co">#&gt; Warning: The ICD mentioned above matches to "NA" due to the format or other</span>
<span class="co">#&gt; issues.</span>
<span class="co">#&gt; Warning: "Wrong ICD format" means the ICD has wrong format</span>
<span class="co">#&gt; Warning: "Wrong ICD version" means the ICD classify to wrong ICD version (cause</span>
<span class="co">#&gt; the "icd10usingDate" or other issues)</span>
<span class="co">#&gt; Wrong ICD format: total 279 ICD codes (the number of occurrences is in brackets)</span>
<span class="co">#&gt; c("585 (1786)", "5640 (1595)", "6009 (567)", "2740 (443)", "5234 (438)", "5210 (414)", "6000 (393)", "5997 (296)", "7902 (288)", "V048 (268)")</span>
<span class="co">#&gt;  </span>
<span class="co">#&gt; Wrong ICD version: total 48 ICD codes (the number of occurrences is in brackets)</span>
<span class="co">#&gt; c("25000 (3)", "07030 (2)", "1550 (2)", "2449 (2)", "2724 (2)", "4019 (2)", "03849 (1)", "05319 (1)", "1749 (1)", "1962 (1)")</span>
<span class="co">#&gt;  </span>
<span class="co">#&gt; Warning: The ICD mentioned above matches to "NA" due to the format or other</span>
<span class="co">#&gt; issues.</span>
<span class="co">#&gt; Warning: "Wrong ICD format" means the ICD has wrong format</span>
<span class="co">#&gt; Warning: "Wrong ICD version" means the ICD classify to wrong ICD version (cause</span>
<span class="co">#&gt; the "icd10usingDate" or other issues)</span>
<span class="co">#&gt; Wrong ICD format: total 227 ICD codes (the number of occurrences is in brackets)</span>
<span class="co">#&gt; c("585 (1809)", "5640 (1763)", "6009 (692)", "5234 (511)", "5210 (495)", "6000 (476)", "2740 (454)", "V048 (326)", "5997 (322)", "7902 (309)")</span>
<span class="co">#&gt;  </span>
<span class="co">#&gt; Warning: The ICD mentioned above matches to "NA" due to the format or other</span>
<span class="co">#&gt; issues.</span>
<span class="co">#&gt; Warning: "Wrong ICD format" means the ICD has wrong format</span>
<span class="co">#&gt; Warning: "Wrong ICD version" means the ICD classify to wrong ICD version (cause</span>
<span class="co">#&gt; the "icd10usingDate" or other issues)</span>
<span class="co">#&gt; Wrong ICD format: total 190 ICD codes (the number of occurrences is in brackets)</span>
<span class="co">#&gt; c("5640 (1419)", "585 (1290)", "6009 (634)", "5210 (493)", "5234 (463)", "2740 (449)", "6000 (431)", "V048 (318)", "7902 (269)", "2500 (254)")</span>
<span class="co">#&gt;  </span>
<span class="co">#&gt; Warning: The ICD mentioned above matches to "NA" due to the format or other</span>
<span class="co">#&gt; issues.</span>
<span class="co">#&gt; Warning: "Wrong ICD format" means the ICD has wrong format</span>
<span class="co">#&gt; Warning: "Wrong ICD version" means the ICD classify to wrong ICD version (cause</span>
<span class="co">#&gt; the "icd10usingDate" or other issues)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">windowcut</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt;    periodage window_N   ID 1 2 3 4 5 6 7</span>
<span class="co">#&gt; 1:     37.49        1    1 0 0 0 0 0 0 0</span>
<span class="co">#&gt; 2:     68.53        1   10 0 0 0 0 0 0 0</span>
<span class="co">#&gt; 3:      39.3        1  100 0 0 0 0 0 0 0</span>
<span class="co">#&gt; 4:     43.71        1 1000 0 0 0 0 0 0 0</span>
<span class="co">#&gt; 5:     88.02        1 1001 0 0 0 0 0 0 0</span>
<span class="co">#&gt; 6:     36.31        1 1002 0 0 0 0 0 0 0</span></code></pre></div>
<p>以上述結果說明：<br>
periodage代表該個案在該時間窗的年紀。1為大於等於45歲；0則反之。<br>
window_N代表時間窗的次序，數字越小越接近指標日。<br>
其餘的數字欄位為CCS的編碼，1表示該個案於該時間窗中得到該CCS疾病。</p>
</div>
<div id="四選擇特徵" class="section level3">
<h3 class="hasAnchor">
<a href="#%E5%9B%9B%E9%81%B8%E6%93%87%E7%89%B9%E5%BE%B5" class="anchor"></a>四、選擇特徵</h3>
<p>以grouped codes的方式，將ICD轉換成CCS，並且進行COX單變量回歸後，選出p-value&lt;0.05 &amp; 得病人數&gt;casecount_limit的特徵；<br>
可以用全長度資料做一次特徵篩選，也可以做多時間窗的特徵篩選。</p>
<p>需設定的參數有：<br><code>icdcount</code>：定義多少個疾病診斷碼(ICD)視為該患者具有該疾病(ccs)，每個window會分開計算。<br><code>casecount_limit</code>：若罹患某疾病(CCS)的人數過少，可設定最低下限予以限制，避免被篩選為特徵。<br><code>predictwindow</code>: 預測天數，意指「想要於指標日多久前進行預測」。<br><code>window</code>：設定時間窗的長度。<br><code>N</code>：設定時間窗數量，注意，若該個案在某時間窗中沒有診斷資料，將會自動補0。<br><code>isDescription</code>：結果呈現的特徵表是否顯示CCS的中文描述。</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">length</span><span class="op">$</span><span class="va">DataFile_rec</span><span class="op">)</span>
<span class="co">#&gt;      ID  ICD       date</span>
<span class="co">#&gt; 1: 5191 4019 1965-07-08</span>
<span class="co">#&gt; 2: 5191 2720 1965-07-08</span>
<span class="co">#&gt; 3: 5191 7840 1965-07-08</span>
<span class="co">#&gt; 4: 5191 4019 1965-09-30</span>
<span class="co">#&gt; 5: 5191 2720 1965-09-30</span>
<span class="co">#&gt; 6: 5191 7840 1965-09-30</span>
<span class="co">#forselect &lt;- length$DataFile_rec[length$DataFile_rec$ID %in% match$ID,]</span>
<span class="va">forselect</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html">merge</a></span><span class="op">(</span><span class="va">record_dm</span>,<span class="va">pat_dm</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ID"</span>,<span class="st">"label"</span><span class="op">)</span><span class="op">]</span>,by<span class="op">=</span><span class="st">"ID"</span>,all.x <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>
<span class="va">feature</span> <span class="op">&lt;-</span> <span class="fu">selectFeature</span><span class="op">(</span>DataFile <span class="op">=</span> <span class="va">forselect</span>,
                         ID <span class="op">=</span> <span class="va">ID</span>,
                         ICD <span class="op">=</span> <span class="va">ICD</span>,
                         date <span class="op">=</span> <span class="va">date</span>,
                         icdcount <span class="op">=</span> <span class="fl">2</span>,
                         <span class="co">#BIRTHDAY = NULL,</span>
                         label <span class="op">=</span> <span class="va">label</span>,
                         casecount_limit <span class="op">=</span> <span class="fl">10</span>,
                         type <span class="op">=</span> <span class="st">"single"</span>,
                         predictwindow <span class="op">=</span> <span class="fl">180</span>,
                         window <span class="op">=</span> <span class="fl">360</span>,
                         N <span class="op">=</span> <span class="fl">5</span>,
                         isDescription <span class="op">=</span> <span class="cn">F</span>
                         <span class="op">)</span>
<span class="co">#&gt; Wrong ICD format: total 803 ICD codes (the number of occurrences is in brackets)</span>
<span class="co">#&gt; c("5640 (15394)", "585 (12586)", "2500 (9200)", "2740 (5371)", "6009 (4601)", "5210 (4426)", "5714 (3990)", "5234 (3576)", "6000 (3024)", "V048 (2817)")</span>
<span class="co">#&gt;  </span>
<span class="co">#&gt; Wrong ICD version: total 63 ICD codes (the number of occurrences is in brackets)</span>
<span class="co">#&gt; c("25000 (3)", "07030 (2)", "1550 (2)", "2449 (2)", "2724 (2)", "2761 (2)", "4019 (2)", "03849 (1)", "05319 (1)", "1533 (1)")</span>
<span class="co">#&gt;  </span>
<span class="co">#&gt; Warning: The ICD mentioned above matches to "NA" due to the format or other</span>
<span class="co">#&gt; issues.</span>
<span class="co">#&gt; Warning: "Wrong ICD format" means the ICD has wrong format</span>
<span class="co">#&gt; Warning: "Wrong ICD version" means the ICD classify to wrong ICD version (cause</span>
<span class="co">#&gt; the "icd10usingDate" or other issues)</span>
<span class="co">#&gt; Wrong ICD format: total 322 ICD codes (the number of occurrences is in brackets)</span>
<span class="co">#&gt; c("585 (1352)", "M791 (894)", "E780 (831)", "5640 (784)", "K0532 (539)", "E11359 (532)", "2500 (381)", "Z2251 (317)", "6009 (247)", "Z2252 (235)")</span>
<span class="co">#&gt;  </span>
<span class="co">#&gt; Wrong ICD version: total 9 ICD codes (the number of occurrences is in brackets)</span>
<span class="co">#&gt; c("1533 (1)", "2390 (1)", "2800 (1)", "28522 (1)", "34291 (1)", "34292 (1)", "43491 (1)", "4373 (1)", "V5789 (1)")</span>
<span class="co">#&gt;  </span>
<span class="co">#&gt; Warning: The ICD mentioned above matches to "NA" due to the format or other</span>
<span class="co">#&gt; issues.</span>
<span class="co">#&gt; Warning: "Wrong ICD format" means the ICD has wrong format</span>
<span class="co">#&gt; Warning: "Wrong ICD version" means the ICD classify to wrong ICD version (cause</span>
<span class="co">#&gt; the "icd10usingDate" or other issues)</span>
<span class="co">#&gt; Wrong ICD format: total 325 ICD codes (the number of occurrences is in brackets)</span>
<span class="co">#&gt; c("585 (1012)", "E780 (777)", "M791 (771)", "5640 (761)", "E11359 (505)", "K0532 (468)", "Z2251 (315)", "2500 (277)", "6009 (242)", "2740 (237)")</span>
<span class="co">#&gt;  </span>
<span class="co">#&gt; Wrong ICD version: total 7 ICD codes (the number of occurrences is in brackets)</span>
<span class="co">#&gt; c("2761 (1)", "2768 (1)", "53011 (1)", "53390 (1)", "53540 (1)", "5781 (1)", "7948 (1)")</span>
<span class="co">#&gt;  </span>
<span class="co">#&gt; Warning: The ICD mentioned above matches to "NA" due to the format or other</span>
<span class="co">#&gt; issues.</span>
<span class="co">#&gt; Warning: "Wrong ICD format" means the ICD has wrong format</span>
<span class="co">#&gt; Warning: "Wrong ICD version" means the ICD classify to wrong ICD version (cause</span>
<span class="co">#&gt; the "icd10usingDate" or other issues)</span>
<span class="co">#&gt; Wrong ICD format: total 279 ICD codes (the number of occurrences is in brackets)</span>
<span class="co">#&gt; c("585 (1786)", "5640 (1595)", "6009 (567)", "2740 (443)", "5234 (438)", "5210 (414)", "6000 (393)", "5997 (296)", "7902 (288)", "V048 (268)")</span>
<span class="co">#&gt;  </span>
<span class="co">#&gt; Wrong ICD version: total 48 ICD codes (the number of occurrences is in brackets)</span>
<span class="co">#&gt; c("25000 (3)", "07030 (2)", "1550 (2)", "2449 (2)", "2724 (2)", "4019 (2)", "03849 (1)", "05319 (1)", "1749 (1)", "1962 (1)")</span>
<span class="co">#&gt;  </span>
<span class="co">#&gt; Warning: The ICD mentioned above matches to "NA" due to the format or other</span>
<span class="co">#&gt; issues.</span>
<span class="co">#&gt; Warning: "Wrong ICD format" means the ICD has wrong format</span>
<span class="co">#&gt; Warning: "Wrong ICD version" means the ICD classify to wrong ICD version (cause</span>
<span class="co">#&gt; the "icd10usingDate" or other issues)</span>
<span class="co">#&gt; Wrong ICD format: total 227 ICD codes (the number of occurrences is in brackets)</span>
<span class="co">#&gt; c("585 (1809)", "5640 (1763)", "6009 (692)", "5234 (511)", "5210 (495)", "6000 (476)", "2740 (454)", "V048 (326)", "5997 (322)", "7902 (309)")</span>
<span class="co">#&gt;  </span>
<span class="co">#&gt; Warning: The ICD mentioned above matches to "NA" due to the format or other</span>
<span class="co">#&gt; issues.</span>
<span class="co">#&gt; Warning: "Wrong ICD format" means the ICD has wrong format</span>
<span class="co">#&gt; Warning: "Wrong ICD version" means the ICD classify to wrong ICD version (cause</span>
<span class="co">#&gt; the "icd10usingDate" or other issues)</span>
<span class="co">#&gt; Wrong ICD format: total 190 ICD codes (the number of occurrences is in brackets)</span>
<span class="co">#&gt; c("5640 (1419)", "585 (1290)", "6009 (634)", "5210 (493)", "5234 (463)", "2740 (449)", "6000 (431)", "V048 (318)", "7902 (269)", "2500 (254)")</span>
<span class="co">#&gt;  </span>
<span class="co">#&gt; Warning: The ICD mentioned above matches to "NA" due to the format or other</span>
<span class="co">#&gt; issues.</span>
<span class="co">#&gt; Warning: "Wrong ICD format" means the ICD has wrong format</span>
<span class="co">#&gt; Warning: "Wrong ICD version" means the ICD classify to wrong ICD version (cause</span>
<span class="co">#&gt; the "icd10usingDate" or other issues)</span>
<span class="co">#&gt; Warning in set(x, j = name, value = value): Column 'periodage' does not exist to</span>
<span class="co">#&gt; remove</span>
<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>
<span class="co">#&gt; Warning in melt.data.table(setDT(CCSWide_num), na.rm = TRUE): id.vars and</span>
<span class="co">#&gt; measure.vars are internally guessed when both are 'NULL'. All non-numeric/</span>
<span class="co">#&gt; integer/logical type columns are considered id.vars, which in this case are</span>
<span class="co">#&gt; columns []. Consider providing at least one of 'id' or 'measure' vars in future.</span>
<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>
<span class="co">#&gt; Warning in melt.data.table(setDT(CCSWide_num), na.rm = TRUE): id.vars and</span>
<span class="co">#&gt; measure.vars are internally guessed when both are 'NULL'. All non-numeric/</span>
<span class="co">#&gt; integer/logical type columns are considered id.vars, which in this case are</span>
<span class="co">#&gt; columns []. Consider providing at least one of 'id' or 'measure' vars in future.</span>
<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>
<span class="co">#&gt; Warning in melt.data.table(setDT(CCSWide_num), na.rm = TRUE): id.vars and</span>
<span class="co">#&gt; measure.vars are internally guessed when both are 'NULL'. All non-numeric/</span>
<span class="co">#&gt; integer/logical type columns are considered id.vars, which in this case are</span>
<span class="co">#&gt; columns []. Consider providing at least one of 'id' or 'measure' vars in future.</span>
<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>
<span class="co">#&gt; Warning in melt.data.table(setDT(CCSWide_num), na.rm = TRUE): id.vars and</span>
<span class="co">#&gt; measure.vars are internally guessed when both are 'NULL'. All non-numeric/</span>
<span class="co">#&gt; integer/logical type columns are considered id.vars, which in this case are</span>
<span class="co">#&gt; columns []. Consider providing at least one of 'id' or 'measure' vars in future.</span>
<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>

<span class="co">#&gt; Warning in coxph.fit(X, Y, istrat, offset, init, control, weights = weights, :</span>
<span class="co">#&gt; Loglik converged before variable 1 ; coefficient may be infinite.</span>
<span class="co">#&gt; Warning in melt.data.table(setDT(CCSWide_num), na.rm = TRUE): id.vars and</span>
<span class="co">#&gt; measure.vars are internally guessed when both are 'NULL'. All non-numeric/</span>
<span class="co">#&gt; integer/logical type columns are considered id.vars, which in this case are</span>
<span class="co">#&gt; columns []. Consider providing at least one of 'id' or 'measure' vars in future.</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">feature</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt;    CCS_CATEGORY        HR  Pr(&gt;|z|) case count selected</span>
<span class="co">#&gt; 1:        `100`        NA        NA          0    FALSE</span>
<span class="co">#&gt; 2:        `101` 1.1359540 0.8986201          5    FALSE</span>
<span class="co">#&gt; 3:        `102` 0.9167049 0.6618345        140    FALSE</span>
<span class="co">#&gt; 4:        `103` 0.4408640 0.4130180         12    FALSE</span>
<span class="co">#&gt; 5:        `104` 1.4401506 0.1252782         65    FALSE</span>
<span class="co">#&gt; 6:        `105` 0.2356265 0.1485303         19    FALSE</span></code></pre></div>
<p>以上述結果說明： feature涵蓋每個時間窗的篩選結果，有幾個時間窗就有幾個table。<br>
以第一個table舉例，HR為<code>100</code>的風險比率；Pr(&gt;|z|)為p-value；case count為該時間窗中共有多少個案患病，最後，若p-value&lt;0.05 &amp; 得病人數&gt;casecount_limit會在selected顯示為TRUE。</p>
</div>
<div id="五以cox回歸建立預測模型" class="section level3">
<h3 class="hasAnchor">
<a href="#%E4%BA%94%E4%BB%A5cox%E5%9B%9E%E6%AD%B8%E5%BB%BA%E7%AB%8B%E9%A0%90%E6%B8%AC%E6%A8%A1%E5%9E%8B" class="anchor"></a>五、以COX回歸建立預測模型</h3>
<p>使用grouped codes的方式，用CCS為預測變量進行建模。 需提供三種資料表來進行建模。分別是<br>
1. <strong>DataFile_cutdata</strong>：劃分為時間窗的資料，使用cutWindow function可以獲得；<br>
2. <strong>DataFile_feature</strong>：要放入作為預測變量的特徵；<br>
3. <strong>DataFile_personal</strong>：個案資料，包含ID、label、SEX、indexage，若有需放入一併建模的特徵，也須於此表格提供；<br>
另外，需設定的參數有：<br><code>predictor</code>：除了CCS之外，若是有個案相關資料須一併做為預測變量進行建模，需於此填入變量名稱。並於DataFile_personal提供該變量資料。<br><code>method</code>：分為“per window”以及“one window”兩種方法，兩種方法的差別在於DataFile_feature的不同，若是多時間窗的特徵篩選，此參數應設為“per window”，若是沒區分時間窗的特徵則設為“one window”。</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">record_dm</span> <span class="op">&lt;-</span> <span class="va">record_dm</span>
<span class="va">lengthdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">record_dm</span><span class="op">[</span>,<span class="va">futime</span><span class="op">:=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span>,by<span class="op">=</span><span class="st">"ID"</span><span class="op">]</span><span class="op">[</span>,<span class="fu">.</span><span class="op">(</span><span class="va">ID</span>,<span class="va">futime</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>
<span class="co"># lengthdata &lt;- unique(length$DataFile_rec[,futime:=max(date)-min(date),by="ID"][,.(ID,futime)])</span>

<span class="va">personal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html">merge</a></span><span class="op">(</span><span class="va">pat_dm</span><span class="op">[</span>,<span class="fu">.</span><span class="op">(</span><span class="va">ID</span>,<span class="va">label</span>,<span class="va">SEX</span>,<span class="va">age</span><span class="op">)</span>,<span class="op">]</span>,<span class="va">lengthdata</span>,by<span class="op">=</span><span class="st">"ID"</span>,all.x<span class="op">=</span><span class="cn">T</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">windowcut</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt;    periodage window_N   ID 1 2 3 4 5 6 7</span>
<span class="co">#&gt; 1:     37.49        1    1 0 0 0 0 0 0 0</span>
<span class="co">#&gt; 2:     68.53        1   10 0 0 0 0 0 0 0</span>
<span class="co">#&gt; 3:      39.3        1  100 0 0 0 0 0 0 0</span>
<span class="co">#&gt; 4:     43.71        1 1000 0 0 0 0 0 0 0</span>
<span class="co">#&gt; 5:     88.02        1 1001 0 0 0 0 0 0 0</span>
<span class="co">#&gt; 6:     36.31        1 1002 0 0 0 0 0 0 0</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">feature</span><span class="op">)</span>
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt;      CCS_CATEGORY        HR     Pr(&gt;|z|) case count selected</span>
<span class="co">#&gt;   1:        `100`        NA           NA          0    FALSE</span>
<span class="co">#&gt;   2:        `101` 1.1359540 8.986201e-01          5    FALSE</span>
<span class="co">#&gt;   3:        `102` 0.9167049 6.618345e-01        140    FALSE</span>
<span class="co">#&gt;   4:        `103` 0.4408640 4.130180e-01         12    FALSE</span>
<span class="co">#&gt;   5:        `104` 1.4401506 1.252782e-01         65    FALSE</span>
<span class="co">#&gt;  ---                                                        </span>
<span class="co">#&gt; 279:         `96` 0.8638234 5.384038e-01        104    FALSE</span>
<span class="co">#&gt; 280:         `97` 1.5362250 3.383316e-01         19    FALSE</span>
<span class="co">#&gt; 281:         `98` 0.7826311 2.914741e-04       2031     TRUE</span>
<span class="co">#&gt; 282:         `99` 0.2995562 2.713128e-09        385     TRUE</span>
<span class="co">#&gt; 283:          `9` 1.2363507 7.643832e-01          8    FALSE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]]</span>
<span class="co">#&gt;      CCS_CATEGORY           HR     Pr(&gt;|z|) case count selected</span>
<span class="co">#&gt;   1:        `100`           NA           NA          0    FALSE</span>
<span class="co">#&gt;   2:        `101` 1.669370e-05 9.818850e-01          1    FALSE</span>
<span class="co">#&gt;   3:        `102` 8.522117e-01 4.392136e-01        133    FALSE</span>
<span class="co">#&gt;   4:        `103` 2.254599e-06 9.806115e-01          9    FALSE</span>
<span class="co">#&gt;   5:        `104` 1.150514e+00 5.900308e-01         66    FALSE</span>
<span class="co">#&gt;  ---                                                           </span>
<span class="co">#&gt; 279:         `96` 7.892110e-01 3.792426e-01         91    FALSE</span>
<span class="co">#&gt; 280:         `97` 2.305692e+00 1.863022e-02         20     TRUE</span>
<span class="co">#&gt; 281:         `98` 6.033840e-01 7.321698e-13       2013     TRUE</span>
<span class="co">#&gt; 282:         `99` 5.218526e-01 2.567535e-03        198     TRUE</span>
<span class="co">#&gt; 283:          `9` 6.136914e-06 9.800571e-01          4    FALSE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[3]]</span>
<span class="co">#&gt;      CCS_CATEGORY           HR     Pr(&gt;|z|) case count selected</span>
<span class="co">#&gt;   1:        `100`           NA           NA          0    FALSE</span>
<span class="co">#&gt;   2:        `101` 1.669370e-05 9.818850e-01          1    FALSE</span>
<span class="co">#&gt;   3:        `102` 7.684799e-01 2.819049e-01        103    FALSE</span>
<span class="co">#&gt;   4:        `103` 6.430373e-01 6.589780e-01          8    FALSE</span>
<span class="co">#&gt;   5:        `104` 1.118403e+00 6.886239e-01         56    FALSE</span>
<span class="co">#&gt;  ---                                                           </span>
<span class="co">#&gt; 279:         `96` 6.745959e-01 1.942691e-01         78    FALSE</span>
<span class="co">#&gt; 280:         `97` 1.528701e+00 3.969620e-01         13    FALSE</span>
<span class="co">#&gt; 281:         `98` 5.888267e-01 1.137646e-12       1666     TRUE</span>
<span class="co">#&gt; 282:         `99` 8.271670e-01 4.128820e-01        108    FALSE</span>
<span class="co">#&gt; 283:          `9` 6.139279e-06 9.841717e-01          3    FALSE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[4]]</span>
<span class="co">#&gt;      CCS_CATEGORY           HR     Pr(&gt;|z|) case count selected</span>
<span class="co">#&gt;   1:        `100`           NA           NA          0    FALSE</span>
<span class="co">#&gt;   2:        `101` 1.669370e-05 9.818850e-01          1    FALSE</span>
<span class="co">#&gt;   3:        `102` 5.328875e-01 3.793724e-02         95     TRUE</span>
<span class="co">#&gt;   4:        `103` 2.253480e-06 9.788820e-01          9    FALSE</span>
<span class="co">#&gt;   5:        `104` 8.536307e-01 6.186096e-01         54    FALSE</span>
<span class="co">#&gt;  ---                                                           </span>
<span class="co">#&gt; 279:         `96` 7.288815e-01 3.198272e-01         65    FALSE</span>
<span class="co">#&gt; 280:         `97` 8.793802e-01 8.559128e-01         10    FALSE</span>
<span class="co">#&gt; 281:         `98` 5.269434e-01 1.149055e-15       1476     TRUE</span>
<span class="co">#&gt; 282:         `99` 7.696068e-01 3.143129e-01         89    FALSE</span>
<span class="co">#&gt; 283:          `9` 2.257284e-06 9.860020e-01          4    FALSE</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[5]]</span>
<span class="co">#&gt;      CCS_CATEGORY           HR     Pr(&gt;|z|) case count selected</span>
<span class="co">#&gt;   1:        `100`           NA           NA          0    FALSE</span>
<span class="co">#&gt;   2:        `101`           NA           NA          0    FALSE</span>
<span class="co">#&gt;   3:        `102` 6.826048e-01 1.715563e-01         85    FALSE</span>
<span class="co">#&gt;   4:        `103` 2.255908e-06 9.829993e-01          6    FALSE</span>
<span class="co">#&gt;   5:        `104` 1.036201e+00 9.025698e-01         55    FALSE</span>
<span class="co">#&gt;  ---                                                           </span>
<span class="co">#&gt; 279:         `96` 4.285202e-01 5.878399e-02         50    FALSE</span>
<span class="co">#&gt; 280:         `97` 1.363301e+00 6.615263e-01          7    FALSE</span>
<span class="co">#&gt; 281:         `98` 4.371710e-01 5.614932e-21       1337     TRUE</span>
<span class="co">#&gt; 282:         `99` 5.320865e-01 5.959822e-02         73    FALSE</span>
<span class="co">#&gt; 283:          `9` 7.745692e-01 7.984815e-01          6    FALSE</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">personal</span><span class="op">)</span>
<span class="co">#&gt;      ID label SEX   age    futime</span>
<span class="co">#&gt; 1:    1     1   M 39.02 3033 days</span>
<span class="co">#&gt; 2:   10     1   M 70.14 3933 days</span>
<span class="co">#&gt; 3:  100     1   M 42.24   31 days</span>
<span class="co">#&gt; 4: 1000     1   M 45.20 3222 days</span>
<span class="co">#&gt; 5: 1001     0   F 89.50 6322 days</span>
<span class="co">#&gt; 6: 1002     0   M 37.78 6473 days</span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">coxmodel</span> <span class="op">&lt;-</span> <span class="fu">analWindow_COX</span><span class="op">(</span>DataFile_cutdata <span class="op">=</span> <span class="va">windowcut</span>,
                         window_N <span class="op">=</span> <span class="va">window_N</span>,
                         ID <span class="op">=</span> <span class="va">ID</span>,
                         DataFile_feature <span class="op">=</span> <span class="va">feature</span>,
                         DataFile_personal <span class="op">=</span> <span class="va">personal</span>,
                         label <span class="op">=</span> <span class="va">label</span>,
                         futime <span class="op">=</span> <span class="va">futime</span>,
                         predictor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"SEX"</span>,<span class="st">"age"</span><span class="op">)</span>,
                         <span class="co">#periodage = periodage,</span>
                         isDescription <span class="op">=</span> <span class="cn">F</span>,
                         method <span class="op">=</span> <span class="st">"per window"</span>,
                         N <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>
<span class="co">#&gt; Warning in melt.data.table(setDT(CCSWide_num), na.rm = TRUE): id.vars and</span>
<span class="co">#&gt; measure.vars are internally guessed when both are 'NULL'. All non-numeric/</span>
<span class="co">#&gt; integer/logical type columns are considered id.vars, which in this case are</span>
<span class="co">#&gt; columns []. Consider providing at least one of 'id' or 'measure' vars in future.</span>

<span class="co">#&gt; Warning in melt.data.table(setDT(CCSWide_num), na.rm = TRUE): id.vars and</span>
<span class="co">#&gt; measure.vars are internally guessed when both are 'NULL'. All non-numeric/</span>
<span class="co">#&gt; integer/logical type columns are considered id.vars, which in this case are</span>
<span class="co">#&gt; columns []. Consider providing at least one of 'id' or 'measure' vars in future.</span>

<span class="co">#&gt; Warning in melt.data.table(setDT(CCSWide_num), na.rm = TRUE): id.vars and</span>
<span class="co">#&gt; measure.vars are internally guessed when both are 'NULL'. All non-numeric/</span>
<span class="co">#&gt; integer/logical type columns are considered id.vars, which in this case are</span>
<span class="co">#&gt; columns []. Consider providing at least one of 'id' or 'measure' vars in future.</span>

<span class="co">#&gt; Warning in melt.data.table(setDT(CCSWide_num), na.rm = TRUE): id.vars and</span>
<span class="co">#&gt; measure.vars are internally guessed when both are 'NULL'. All non-numeric/</span>
<span class="co">#&gt; integer/logical type columns are considered id.vars, which in this case are</span>
<span class="co">#&gt; columns []. Consider providing at least one of 'id' or 'measure' vars in future.</span>

<span class="co">#&gt; Warning in melt.data.table(setDT(CCSWide_num), na.rm = TRUE): id.vars and</span>
<span class="co">#&gt; measure.vars are internally guessed when both are 'NULL'. All non-numeric/</span>
<span class="co">#&gt; integer/logical type columns are considered id.vars, which in this case are</span>
<span class="co">#&gt; columns []. Consider providing at least one of 'id' or 'measure' vars in future.</span>
<span class="va">coxmodel</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; Error in coxmodel[[1]] %&gt;% head(): could not find function "%&gt;%"</span></code></pre></div>
</div>
<div id="六以lstm建立預測模型" class="section level3">
<h3 class="hasAnchor">
<a href="#%E5%85%AD%E4%BB%A5lstm%E5%BB%BA%E7%AB%8B%E9%A0%90%E6%B8%AC%E6%A8%A1%E5%9E%8B" class="anchor"></a>六、以LSTM建立預測模型</h3>
<p>LSTM為RNN中最常使用的模型，運用於做時間序列分析有良好的效果，在運算過程中能自動擷取具影響力的危險因子進行建模。使用analyWindow_LSTM()，使用者可以不需了解tensorflow中複雜且與此研究類型不相關的參數，研究者可直接根據analyWindow_LSTM()所需的參數進行設定，便可迅速得到以LSTM建立的疾病診斷時序預測模型。 此方法可用於多個時間窗建立預測模型，也可用於單個時間窗建立預測模型。<br>
需提供二種資料表來進行建模。分別是<br>
1. <strong>DataFile_cutdata</strong>：劃分為時間窗的資料，使用cutWindow()可以建構；<br>
2. <strong>DataFile_personal</strong>：個案資料，包含ID、label、SEX、indexage，若有需放入一併建模的特徵，也須於此表格提供；<br>
另外，需設定的參數有：<br><code>predictor</code>：除了CCS之外，若是有個案相關資料須一併做為預測變量進行建模，需於此填入變量名稱。並於DataFile_personal提供該變量資料。<br><code>N</code>: 時間窗數量 <code>batch_size</code>：batch size將決定一次訓練的樣本數目。預設為100。 <code>Epoch</code>：當一個完整的資料集通過了神經網路一次並且返回了一次，這個過程稱為一次epoch。預設為10，但會經過Validation的驗證後找到最佳的迭代次數， <code>units</code>：設定隱藏層的神經元數量。預設為16，常見的還有32、64等。</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://keras.rstudio.com">keras</a></span><span class="op">)</span>
<span class="co">#use_session_with_seed(10) #use_session_with_seed will be deprecated in the future. use set_random_seed instead.</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rstudio/tensorflow">tensorflow</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/tensorflow/man/set_random_seed.html">set_random_seed</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/tensorflow/man/install_tensorflow.html">install_tensorflow</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Installation complete.</span>
<span class="co"># check version</span>
<span class="fu"><a href="https://rdrr.io/r/utils/packageDescription.html">packageVersion</a></span><span class="op">(</span><span class="st">"keras"</span><span class="op">)</span>
<span class="co">#&gt; [1] '2.4.0'</span>
<span class="fu"><a href="https://rdrr.io/r/utils/packageDescription.html">packageVersion</a></span><span class="op">(</span><span class="st">"tensorflow"</span><span class="op">)</span>
<span class="co">#&gt; [1] '2.4.0'</span>
<span class="co"># lstm &lt;- analWindow_LSTM(DataFile_cutdata=windowcut,</span>
<span class="co">#                          window_N,</span>
<span class="co">#                          ID,</span>
<span class="co">#                          periodage=NULL,</span>
<span class="co">#                          DataFile_personal=personal,</span>
<span class="co">#                          label,</span>
<span class="co">#                          predictor=c("SEX"),</span>
<span class="co">#                          N=5)</span>
<span class="va">lstm</span> <span class="op">&lt;-</span> <span class="fu">analWindow_LSTM</span><span class="op">(</span>DataFile_cutdata<span class="op">=</span><span class="va">windowcut</span>,
                         <span class="va">window_N</span>,
                         <span class="va">ID</span>,
                         periodage<span class="op">=</span><span class="cn">NULL</span>,
                         DataFile_personal<span class="op">=</span><span class="va">pat_dm</span>,
                         <span class="va">label</span>,
                         predictor<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"SEX"</span><span class="op">)</span>,
                         N<span class="op">=</span><span class="fl">5</span><span class="op">)</span>
<span class="co">## evaluate</span>
<span class="va">model</span> <span class="op">&lt;-</span> <span class="va">lstm</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>
<span class="va">x_test</span> <span class="op">&lt;-</span> <span class="va">lstm</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>
<span class="va">y_test</span> <span class="op">&lt;-</span> <span class="va">lstm</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>
<span class="va">model</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/pkg/tensorflow/man/evaluate.html">evaluate</a></span><span class="op">(</span><span class="va">x_test</span>, <span class="va">y_test</span>, batch_size <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> 
<span class="co">#&gt;      loss       auc </span>
<span class="co">#&gt; 0.4582112 0.7421075</span>
<span class="va">model</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">x_test</span>, <span class="va">y_test</span>, batch_size <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt;             [,1]</span>
<span class="co">#&gt; [1,] 0.008280158</span>
<span class="co">#&gt; [2,] 0.009472787</span>
<span class="co">#&gt; [3,] 0.008395851</span>
<span class="co">#&gt; [4,] 0.341553032</span>
<span class="co">#&gt; [5,] 0.003347009</span>
<span class="co">#&gt; [6,] 0.092177123</span></code></pre></div>
</div>
<div id="七視覺化" class="section level3">
<h3 class="hasAnchor">
<a href="#%E4%B8%83%E8%A6%96%E8%A6%BA%E5%8C%96" class="anchor"></a>七、視覺化</h3>
<p>視覺化功能分成三個部分，皆可由前述功能產出的資料直接匯入，輸出視覺化的圖片。<br>
#### grouped code時間窗視覺化。<br>
將各時間窗內的各疾病數量以grouped codes的方式視覺化。 DataFile_cutdata可由cutWindow()的輸出獲得。</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">windowcut</span><span class="op">)</span>
<span class="co">#&gt;    periodage window_N   ID 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20</span>
<span class="co">#&gt; 1:     37.49        1    1 0 0 0 0 0 0 0 0 0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="co">#&gt; 2:     68.53        1   10 0 0 0 0 0 0 0 0 0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="co">#&gt; 3:      39.3        1  100 0 0 0 0 0 0 0 0 0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="co">#&gt; 4:     43.71        1 1000 0 0 0 0 0 0 0 0 0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="co">#&gt; 5:     88.02        1 1001 0 0 0 0 0 0 0 0 0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="co">#&gt; 6:     36.31        1 1002 0 0 0 0 0 0 0 0 0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="co">#&gt;    21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45</span>
<span class="co">#&gt; 1:  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="co">#&gt; 2:  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="co">#&gt; 3:  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="co">#&gt; 4:  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="co">#&gt; 5:  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="co">#&gt; 6:  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="co">#&gt;    46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 76 77 78 79 80 81</span>
<span class="co">#&gt; 1:  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="co">#&gt; 2:  0  0  0  1  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="co">#&gt; 3:  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="co">#&gt; 4:  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="co">#&gt; 5:  0  0  0  1  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="co">#&gt; 6:  0  0  0  0  1  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0</span>
<span class="co">#&gt;    82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104</span>
<span class="co">#&gt; 1:  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0   0   0   0   0   0</span>
<span class="co">#&gt; 2:  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0   0   0   0   0   0</span>
<span class="co">#&gt; 3:  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0   0   0   0   0   0</span>
<span class="co">#&gt; 4:  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0   0   0   0   0   0</span>
<span class="co">#&gt; 5:  0  0  0  0  0  0  0  0  0  0  0  1  0  1  0  0  0  0   0   0   0   0   0</span>
<span class="co">#&gt; 6:  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0   0   0   0   0   0</span>
<span class="co">#&gt;    105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123</span>
<span class="co">#&gt; 1:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="co">#&gt; 2:   0   0   0   0   0   0   0   0   0   1   0   1   0   0   0   0   0   0   0</span>
<span class="co">#&gt; 3:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="co">#&gt; 4:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="co">#&gt; 5:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="co">#&gt; 6:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="co">#&gt;    124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142</span>
<span class="co">#&gt; 1:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="co">#&gt; 2:   0   0   0   0   0   0   0   0   0   1   0   0   0   0   0   0   0   0   0</span>
<span class="co">#&gt; 3:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="co">#&gt; 4:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="co">#&gt; 5:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="co">#&gt; 6:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   0   0</span>
<span class="co">#&gt;    143 144 145 146 147 148 149 151 152 153 154 155 156 157 158 159 160 161 162</span>
<span class="co">#&gt; 1:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="co">#&gt; 2:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="co">#&gt; 3:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="co">#&gt; 4:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="co">#&gt; 5:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="co">#&gt; 6:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="co">#&gt;    163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181</span>
<span class="co">#&gt; 1:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="co">#&gt; 2:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="co">#&gt; 3:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="co">#&gt; 4:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="co">#&gt; 5:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="co">#&gt; 6:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="co">#&gt;    182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200</span>
<span class="co">#&gt; 1:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="co">#&gt; 2:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   0   0   0</span>
<span class="co">#&gt; 3:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="co">#&gt; 4:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="co">#&gt; 5:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   0   0   0</span>
<span class="co">#&gt; 6:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="co">#&gt;    201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219</span>
<span class="co">#&gt; 1:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="co">#&gt; 2:   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="co">#&gt; 3:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="co">#&gt; 4:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="co">#&gt; 5:   0   0   0   1   0   1   0   0   0   0   1   0   0   0   0   0   0   0   0</span>
<span class="co">#&gt; 6:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="co">#&gt;    220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238</span>
<span class="co">#&gt; 1:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="co">#&gt; 2:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="co">#&gt; 3:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="co">#&gt; 4:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="co">#&gt; 5:   0   0   0   0   0   0   1   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="co">#&gt; 6:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="co">#&gt;    239 240 241 242 243 244 245 246 247 248 249 250 251 252 253 254 255 256 257</span>
<span class="co">#&gt; 1:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="co">#&gt; 2:   0   0   0   0   0   0   0   0   0   1   0   0   0   0   0   0   0   0   0</span>
<span class="co">#&gt; 3:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="co">#&gt; 4:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0</span>
<span class="co">#&gt; 5:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1</span>
<span class="co">#&gt; 6:   0   0   0   0   0   0   0   0   0   0   0   1   0   0   0   0   0   0   0</span>
<span class="co">#&gt;    258 259 650 651 652 653 654 655 656 657 658 659 660 661 662 663 670 2601</span>
<span class="co">#&gt; 1:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0    0</span>
<span class="co">#&gt; 2:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0    0</span>
<span class="co">#&gt; 3:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0    0</span>
<span class="co">#&gt; 4:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0    0</span>
<span class="co">#&gt; 5:   0   0   0   0   0   1   0   0   0   0   0   0   0   0   0   0   0    0</span>
<span class="co">#&gt; 6:   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0    0</span>
<span class="co">#&gt;    2602 2603 2604 2605 2606 2607 2608 2609 2610 2611 2612 2613 2614 2615 2616</span>
<span class="co">#&gt; 1:    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0</span>
<span class="co">#&gt; 2:    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0</span>
<span class="co">#&gt; 3:    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0</span>
<span class="co">#&gt; 4:    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0</span>
<span class="co">#&gt; 5:    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0</span>
<span class="co">#&gt; 6:    0    0    0    0    0    0    0    0    0    0    0    0    0    0    0</span>
<span class="co">#&gt;    2617 2618 2619 2620 2621</span>
<span class="co">#&gt; 1:    0    0    0    0    0</span>
<span class="co">#&gt; 2:    0    0    0    0    0</span>
<span class="co">#&gt; 3:    0    0    0    0    0</span>
<span class="co">#&gt; 4:    0    0    0    0    0</span>
<span class="co">#&gt; 5:    0    0    0    0    0</span>
<span class="co">#&gt; 6:    0    0    0    0    0</span>
<span class="fu">plotWindow</span><span class="op">(</span>DataFile_cutdata <span class="op">=</span> <span class="va">windowcut</span><span class="op">)</span></code></pre></div>
<p><img src="dxtime_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<div id="hazard-ratio視覺化" class="section level4">
<h4 class="hasAnchor">
<a href="#hazard-ratio%E8%A6%96%E8%A6%BA%E5%8C%96" class="anchor"></a>Hazard ratio視覺化</h4>
<p>將生存分析後的hazard ratio進行視覺化。<br>
DataFile為從analWindow_COX的輸出可獲得，pvalue為使用者設定。</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">coxmodel</span><span class="op">$</span><span class="va">model_table</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt;    CCS_CATEGORY         exp(coef)        exp(-coef)         lower .95</span>
<span class="co">#&gt; 1:         SEXM  1.09871101537886 0.910157435397309 0.959071300032534</span>
<span class="co">#&gt; 2:        `106`  0.70167480076201  1.42516162603248  0.47567227101268</span>
<span class="co">#&gt; 3:        `108` 0.517865751640957  1.93100238204845 0.249158177213081</span>
<span class="co">#&gt; 4:         `10` 0.771007356244194  1.29700448627533 0.481382517675083</span>
<span class="co">#&gt; 5:        `122`  0.46884544066546  2.13289906068115 0.257959828281112</span>
<span class="co">#&gt; 6:        `126`  1.25076318421422 0.799511860135413 0.993773508399161</span>
<span class="co">#&gt;           upper .95           Pr(&gt;|z|) count</span>
<span class="co">#&gt; 1: 1.25868211808017  0.174657824031076    NA</span>
<span class="co">#&gt; 2: 1.03505618474717 0.0740597100695589   256</span>
<span class="co">#&gt; 3: 1.07636417846042 0.0779298010229538    89</span>
<span class="co">#&gt; 4: 1.23488560875386   0.27921249989663   217</span>
<span class="co">#&gt; 5: 0.85213286385524 0.0129596230152768   183</span>
<span class="co">#&gt; 6:  1.5742103505111 0.0565544567317885   587</span>
<span class="fu">plotHR</span><span class="op">(</span>DataFile <span class="op">=</span> <span class="va">coxmodel</span><span class="op">$</span><span class="va">model_table</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>,
       pvalue <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></code></pre></div>
<p><img src="dxtime_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
</div>
<div id="生存區線視覺化" class="section level4">
<h4 class="hasAnchor">
<a href="#%E7%94%9F%E5%AD%98%E5%8D%80%E7%B7%9A%E8%A6%96%E8%A6%BA%E5%8C%96" class="anchor"></a>生存區線視覺化</h4>
<p>將視覺化將病例組與對照組的生存曲線轉換成grouped code，進行視覺化。<br>
var中填入使用者要看的ccs category。</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">plotSurv</span><span class="op">(</span>DataFile <span class="op">=</span> <span class="va">record_dm</span>,
         ID <span class="op">=</span> <span class="va">ID</span>,
         ICD <span class="op">=</span> <span class="va">ICD</span>,
         date <span class="op">=</span> <span class="va">date</span>,
         DataFile_personal <span class="op">=</span> <span class="va">pat_dm</span>,
         label <span class="op">=</span> <span class="va">label</span>,
         var <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="co">#&gt; Wrong ICD format: total 610 ICD codes (the number of occurrences is in brackets)</span>
<span class="co">#&gt; c("2500 (6480)", "5640 (4245)", "5714 (3052)", "2740 (1808)", "7805 (1762)", "2506 (1690)", "585 (1625)", "7330 (1563)", "5339 (1541)", "2780 (1164)")</span>
<span class="co">#&gt;  </span>
<span class="co">#&gt; Warning: The ICD mentioned above matches to "NA" due to the format or other</span>
<span class="co">#&gt; issues.</span>
<span class="co">#&gt; Warning: "Wrong ICD format" means the ICD has wrong format</span>
<span class="co">#&gt; Warning: "Wrong ICD version" means the ICD classify to wrong ICD version (cause</span>
<span class="co">#&gt; the "icd10usingDate" or other issues)</span></code></pre></div>
<p><img src="dxtime_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by The package maintainer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
